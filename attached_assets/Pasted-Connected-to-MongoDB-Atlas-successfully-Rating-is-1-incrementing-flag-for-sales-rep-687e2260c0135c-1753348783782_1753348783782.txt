Connected to MongoDB Atlas successfully
Rating is 1, incrementing flag for sales rep: 687e2260c0135c6898592265
Call details: {
  callId: '6880f473aef89a323ac882bd',
  salesRepId: new ObjectId('687e2260c0135c6898592265'),
  evaluatedBy: '687e27a7cf86a137eca5b2bd',
  rating: 1,
  experienceTitle: 'Rude, disrespectful, or time-wasting'
}
Connected to MongoDB Atlas successfully
Starting flag increment for user 687e2260c0135c6898592265, reason: Poor call rating (1/5) - Rude, disrespectful, or time-wasting, flagged by: 687e27a7cf86a137eca5b2bd
Found users - Flagged: mlp.yashvantgupta@gmail.com (sales_rep), Flagging: mlp.yashkumar@gmail.com (decision_maker)
Creating flag record: {
  dmId: '687e2260c0135c6898592265',
  flaggedBy: '687e27a7cf86a137eca5b2bd',
  flagType: 'low_rating',
  reason: 'Poor call rating (1/5) - Rude, disrespectful, or time-wasting',
  status: 'open',
  severity: 'medium',
  companyDomain: 'naeberly.com',
  createdAt: 2025-07-24T09:14:29.516Z,
  updatedAt: 2025-07-24T09:14:29.516Z
}
Error incrementing user flag: Error: DMFlags validation failed: description: Path `description` is required., flagType: `low_rating` is not a valid enum value for path `flagType`.
    at ValidationError.inspect (/home/runner/workspace/node_modules/mongoose/lib/error/validation.js:52:26)
    at formatValue (node:internal/util/inspect:829:19)
    at inspect (node:internal/util/inspect:372:10)
    at formatWithOptionsInternal (node:internal/util/inspect:2325:40)
    at formatWithOptions (node:internal/util/inspect:2187:10)
    at console.value (node:internal/console/constructor:350:14)
    at console.warn (node:internal/console/constructor:383:61)
    at SimpleMongoDBStorage.incrementUserFlag (/home/runner/workspace/server/simple-mongodb-storage.ts:1926:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/home/runner/workspace/server/routes.ts:5302:32) {
  errors: {
    description: ValidatorError: Path `description` is required.
        at validate (/home/runner/workspace/node_modules/mongoose/lib/schemaType.js:1404:13)
        at SchemaType.doValidate (/home/runner/workspace/node_modules/mongoose/lib/schemaType.js:1388:7)
        at /home/runner/workspace/node_modules/mongoose/lib/document.js:3105:18
        at process.processTicksAndRejections (node:internal/process/task_queues:77:11) {
      properties: [Object],
      kind: 'required',
      path: 'description',
      value: undefined,
      reason: undefined,
      [Symbol(mongoose#validatorError)]: true
    },
    flagType: ValidatorError: `low_rating` is not a valid enum value for path `flagType`.
        at validate (/home/runner/workspace/node_modules/mongoose/lib/schemaType.js:1404:13)
        at SchemaType.doValidate (/home/runner/workspace/node_modules/mongoose/lib/schemaType.js:1388:7)
        at /home/runner/workspace/node_modules/mongoose/lib/document.js:3105:18
        at process.processTicksAndRejections (node:internal/process/task_queues:77:11) {
      properties: [Object],
      kind: 'enum',
      path: 'flagType',
      value: 'low_rating',
      reason: undefined,
      [Symbol(mongoose#validatorError)]: true
    }
  },
  _message: 'DMFlags validation failed'
}
Error details: DMFlags validation failed: description: Path `description` is required., flagType: `low_rating` is not a valid enum value for path `flagType`.
Error incrementing flag count: Error: DMFlags validation failed: description: Path `description` is required., flagType: `low_rating` is not a valid enum value for path `flagType`.
    at ValidationError.inspect (/home/runner/workspace/node_modules/mongoose/lib/error/validation.js:52:26)
    at formatValue (node:internal/util/inspect:829:19)
    at inspect (node:internal/util/inspect:372:10)
    at formatWithOptionsInternal (node:internal/util/inspect:2325:40)
    at formatWithOptions (node:internal/util/inspect:2187:10)
    at console.value (node:internal/console/constructor:350:14)
    at console.warn (node:internal/console/constructor:383:61)
    at <anonymous> (/home/runner/workspace/server/routes.ts:5310:21)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5) {
  errors: {
    description: ValidatorError: Path `description` is required.
        at validate (/home/runner/workspace/node_modules/mongoose/lib/schemaType.js:1404:13)
        at SchemaType.doValidate (/home/runner/workspace/node_modules/mongoose/lib/schemaType.js:1388:7)
        at /home/runner/workspace/node_modules/mongoose/lib/document.js:3105:18
        at process.processTicksAndRejections (node:internal/process/task_queues:77:11) {
      properties: [Object],
      kind: 'required',
      path: 'description',
      value: undefined,
      reason: undefined,
      [Symbol(mongoose#validatorError)]: true
    },
    flagType: ValidatorError: `low_rating` is not a valid enum value for path `flagType`.
        at validate (/home/runner/workspace/node_modules/mongoose/lib/schemaType.js:1404:13)
        at SchemaType.doValidate (/home/runner/workspace/node_modules/mongoose/lib/schemaType.js:1388:7)
        at /home/runner/workspace/node_modules/mongoose/lib/document.js:3105:18
        at process.processTicksAndRejections (node:internal/process/task_queues:77:11) {
      properties: [Object],
      kind: 'enum',
      path: 'flagType',
      value: 'low_rating',
      reason: undefined,
      [Symbol(mongoose#validatorError)]: true
    }
  },
  _message: 'DMFlags validation failed'
}
Flag error details: DMFlags validation failed: description: Path `description` is required., flagType: `low_rating` is not a valid enum value for path `flagType`.
Connected to MongoDB Atlas successfully
Activity Log saved to database: {
  userId: new ObjectId('687e27a7cf86a137eca5b2bd'),
  action: 'EVALUATE_CALL',
  entityType: 'call',
  entityId: '6880f473aef89a323ac882bd',
  details: 'Evaluated call with rating 1/5',
  timestamp: 2025-07-24T09:14:29.531Z,
  ipAddress: '10.83.4.94',
  userAgent: 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36',
  _id: new ObjectId('6881f9754fc08cb3d3a5f9e4'),
  createdAt: 2025-07-24T09:14:29.534Z,
  updatedAt: 2025-07-24T09:14:29.534Z,
  __v: 0
}
9:14:29 AM [express] POST /api/decision-maker/evaluate-call 200 in 1363ms :: {"success":true,"messagâ€¦
Token verified successfully for user: 687e27a7cf86a137eca5b2bd